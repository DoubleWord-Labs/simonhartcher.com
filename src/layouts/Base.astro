---
import "../pico.violet.css";
import "../styles.css";
import NavBar from '@components/NavBar.astro';
import PostHog from '@components/posthog.astro';
import Turnstile from '@components/CloudFlareTurnstile.astro';
import TurnstileWidget from '@components/TurnstileWidget.astro';

export interface Props {
    title: string;
    description?: string;
    image?: string;
}

const { title, description = "Simon Hartcher's Blog", image } = Astro.props;
const siteTitle = "Simon Hartcher";
const fullTitle = title ? `${title} | ${siteTitle}` : siteTitle;
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="color-scheme" content="light dark" />
        <meta name="description" content={description} />
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@deevus" />
        <meta name="twitter:author" content="@deevus" />
        <meta name="twitter:description" content={description} />
        <meta name="twitter:title" content={fullTitle} />
        {image && <meta name="twitter:image" content={image} />}
        <meta property="og:type" content="website" />
        <meta property="og:title" content={fullTitle} />
        {image && <meta property="og:image" content={image} />}
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <title>{fullTitle}</title>
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Simon Hartcher's Blog RSS Feed"
            href="/rss.xml"
        />
        <script defer src="/main.min.js"></script>
        <PostHog />
        <Turnstile />
    </head>
    <body>
        <div x-data="{ open: false }">
            <form
                method="post"
                action="https://listmonk.simonhartcher.com/subscription/form"
                class="listmonk-form"
            >
                <dialog :open="open">
                    <article>
                        <header>
                            <button
                                aria-label="Close"
                                rel="prev"
                                @click="open = false"></button>
                            <h3>
                                Subscribe for more content delivered to your
                                inbox! ðŸŽ‰
                            </h3>
                        </header>
                        <input type="hidden" name="nonce" />
                        <p>
                            <input
                                type="email"
                                name="email"
                                required
                                placeholder="E-mail"
                            />
                        </p>
                        <p>
                            <input
                                type="text"
                                name="name"
                                placeholder="Name (optional)"
                            />
                        </p>
                        <input
                            id="261b8"
                            type="hidden"
                            name="l"
                            value="261b8248-9c4e-4ab5-a843-d95fab76fee3"
                        />
                        <footer>
                            <TurnstileWidget />
                            <button type="submit" style="margin-bottom: 0">Subscribe</button>
                        </footer>
                    </article>
                </dialog>
            </form>
            <NavBar class="nav__horizontal" siteTitle={siteTitle} />
            <aside class="nav__vertical" x-data="{ mobileMenuOpen: false }">
                <NavBar class="nav__vertical" siteTitle={siteTitle} />
            </aside>
        </div>
        <main id="content" class="container">
            <slot />
        </main>
        <script
            async
            src="https://www.googletagmanager.com/gtag/js?id=G-M5R396MEP8"
        ></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());
            gtag("config", "G-M5R396MEP8");
        </script>
    </body>
</html>
